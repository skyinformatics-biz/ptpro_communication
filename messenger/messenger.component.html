<div *ngIf="this.auth.isAuthenticated()" class="container">

  <div id="ChatBox">
    <Button class="btn btn-primary btn-block chatTitle text-left" *ngIf="myMessengerOpened" (click)="toggleMessenger()">
      <h2 style="margin:0"><span class="fa fa-envelope"></span> Meldinger ({{this.myTotalMessages}})
      </h2>
      <h4 style="margin:0"> Aktive sessjoner ({{this.myTotalContacts}})</h4>
    </Button>
    <!-- Contact List START -->
    <div class="text-center" *ngIf="myMessengerOpened && !myMessengerLoaded">
      <br>
      <i class="fas fa-spinner fa-pulse fa-3x"></i>
    </div>
    <div class="chat-sidebar p-1" *ngIf="myMessengerOpened">
      <div #requestContact></div>
      <!-- 1 Row  -->
      <div class="row contact-item" *ngFor="let session of myMessengerContacts; let i=index"
        (click)="initiateChat(i, session.firstname + ' ' + session.lastname, session.ContactId, session.id)">
        <!-- 2 Col **to 1 Row  -->
        <div class="col-md-3 col-sm-3 col-xs-3 text-center">
          <!-- 3 Img  -->
          <img width="40" height="40" class="img" src="https://fakeimg.pl/50/" />
        </div>
        <!-- 4 Col **to 1 Row -->
        <div class="col-md-9 col-sm-9 col-xs-9">
          <!-- 5 Row **to 4 col  -->
          <div class="row">
            <!-- 6 Col  -->
            <div class="col-md-12">
              <!-- 7 h4  -->
              <h4 [ngClass]="{ 'font-weight-bold': session.bold}" style="margin:0">
                <!-- 8 i   -->
                <i class="fa" [ngClass]="{
                  'fa-clock-o text-warning':session.accepted === 2,
                  'fa-check text-success':session.accepted === 1,
                  'fa-times text-danger':session.accepted === 0
                }" aria-hidden="true"></i> {{session.title}}</h4>
            </div>
          </div>
          <!-- 9 Row **to 4 Col  -->
          <div class="row">
            <!-- 10 col  -->
            <div class="col-md-12 col-sm-12 col-xs-12">
              <!-- 11 h4  -->
              <h4 style="margin:0">
                <!-- 12 i  -->
                <i class="fa fa-user" aria-hidden="true"></i>
                {{session.firstname}} {{session.lastname}}
                ({{this.getRecieverUnreadMessage(session.recieverId, session.total)}})</h4>
            </div>
          </div>
        </div>
        <hr>
      </div>
    </div>
    <!-- Contact List END -->
    <!-- Bottom Messenger expandable   -->
    <Button class="btn btn-primary btn-block chatTitle" *ngIf="!myMessengerOpened" (click)="toggleMessenger()">
      <h2 style="margin:0; color:rgba(255, 255, 255, 0.973);"> <span class="fa fa-envelope"></span> Meldinger
        ({{this.myTotalMessages}})</h2>
      <h4 style="margin:0">Aktive sessjoner ({{this.myTotalContacts}})</h4> <span class="fa fa-setting"></span>
    </Button>
    <div *ngIf="myMessengerOpened">
      <table class="messenger-controller">
        <tr>
          <td>
            <div class="chatItem fa fa-search p-2"></div>
          </td>
          <td>
            <input type="text" class="chatItem search-text" placeholder="Search">
          </td>
          <td>
            <div class="chatItem fa fa-envelope p-2"></div>
          </td>
          <td>
            <div class="chatItem fa fa-cog p-2"></div>
          </td>
        </tr>
      </table>
    </div>
    <!-- Bottom Messenger expandable  -->
  </div>

  <!-- Chat Window 1 START -->
  <div class="chat-box r-15" *ngIf="getChatWindow(0)">
    <div class="chat-head" (click)="toggleChatWindow()">
      <div class="row">
        <div class="col-md-12 text-center">
          <span class="fa fa-user"></span> {{this.ChatWindows.Manager[0].title}}

          <span class="fa fa-close pull-right" (click)="closeWindow(0)"></span>
        </div>
        <div class="row">
          <div class="col-md-12">
            <h6 class="plan-title text-center"><i class="fa fa-medkit"></i> Helseplan 345 &ensp; | &ensp; <i class="fa fa-clock-o"></i> Timeleft : 7 days</h6>
          </div>
        </div>
      </div>
    </div>
    <div class="chat-body">
      <app-messages #chatBody>
      </app-messages>
    </div>
    <div *ngIf="this.ChatWindows.Manager[0].accepted == 1">
      <div class="form-group border-top" style="visibility:hidden"
        [ngStyle]="{'visibility':this.ChatWindows.Manager[0].accepted == 1 ? 'visible' : 'hidden' }"
        *ngIf="getChatWindow(0)">
        <table class="window-controller">
          <tr>
            <td>
              <input #messageText type="text" class="form-control chatItem" placeholder="Melding. . .">
            </td>
            <td (click)="postMessage(0)">
              <div class="form-control fa fa-envelope fa-2x "></div>
            </td>
          </tr>
        </table>
      </div>
    </div>
  </div>
  <!-- Chat Window 1 END-->
</div>
